language: en
early_access: false

reviews:
  profile: chill
  high_level_summary: true
  collapse_walkthrough: true
  poem: false

  # Files to review (use ! prefix to exclude)
  path_filters:
    - "**/*.kt"
    - "**/*.kts"
    - "!**/build/**"
    - "!**/.gradle/**"
    - "!**/out/**"
    - "!**/generated/**"
    - "!**/node_modules/**"
    - "!**/*.md"
    - "!**/*.txt"

  auto_review:
    enabled: true
    auto_incremental_review: true
    drafts: false
    # Ignore dependabot PRs
    ignore_usernames:
      - dependabot
      - "dependabot[bot]"

  path_instructions:
    - path: "**/*.kt"
      instructions: |
        Kotlin best practices to check:

        Language correctness:
        - Null safety: Ensure proper use of nullable types, avoid unnecessary null assertions (!!)
        - Immutability: Prefer val over var, use immutable collections where possible
        - Data class usage: Use data classes for DTOs and value objects
        - Sealed class usage: Use sealed classes for representing restricted hierarchies

        Code quality:
        - Complexity: Flag functions with high cyclomatic complexity (>10)
        - Dead code: Identify unused functions, variables, and imports
        - Naming conventions: Follow Kotlin naming conventions (camelCase for functions/properties, PascalCase for classes)

        Coroutines and concurrency:
        - Structured concurrency: Ensure proper coroutine scope usage
        - Dispatcher misuse: Check for correct dispatcher usage (IO for blocking, Default for CPU-intensive)

        Performance:
        - Avoid unnecessary allocations in hot paths
        - Collection usage: Use appropriate collection types and operations (prefer sequences for large collections with multiple operations)

        API and design:
        - Visibility modifiers: Use appropriate visibility (prefer private/internal over public)
        - Unnecessary public API: Flag overly exposed APIs

        Error handling:
        - Proper exception handling, avoid swallowing exceptions
        - Result usage: Consider using Result type for operations that can fail

        Security:
        - No hardcoded secrets or credentials
        - Use SecureRandom instead of Random for security-sensitive operations
        - Avoid unsafe deserialization
    - path: "**/*.kts"
      instructions: |
        Kotlin script best practices to check:

        Language correctness:
        - Null safety: Ensure proper use of nullable types, avoid unnecessary null assertions (!!)
        - Immutability: Prefer val over var, use immutable collections where possible

        Code quality:
        - Complexity: Flag overly complex scripts
        - Naming conventions: Follow Kotlin naming conventions

        Security:
        - No hardcoded secrets or credentials

  # Kotlin-specific linting via detekt
  tools:
    detekt:
      enabled: true

    # Security scanning
    gitleaks:
      enabled: true
